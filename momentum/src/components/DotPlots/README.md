Adapted from https://gist.github.com/twitched/513ee670ec6b561cef14 and http://bl.ocks.org/phil-pedruco/88cb8a51cdce45f13c7e
